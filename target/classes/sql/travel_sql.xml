<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="travel">
	
	<resultMap type="com.travel.vo.ClientInfoVo" id="clientInfoVo">
			<result property="seq" column="SEQ"/>
			<result property="userName"	column="USER_NAME"/>
			<result property="userPhone" column="USER_PHONE"/>
			<result property="traveCity" column="TRAVE_CITY"/>
			<result property="period" column="PERIOD"/>
			<result property="expend" column="EXPEND"/>
			<result property="transport" column="TRANSPORT"/>
	</resultMap>
	
	<resultMap type="com.travel.vo.TraveInfoVo" id="traveInfoVo">
			<result property="taveSeq" column="TRAVE_SEQ"/>
			<result property="seq" column="SEQ"/>
			<result property="traveDay" column="TRAVE_DAY"/>
			<result property="traveTime" column="TRAVE_TIME"/>
			<result property="traveCity" column="TRAVE_CITY"/>
			<result property="traveCounty" column="TRAVE_COUNTY"/>
			<result property="traveLoc" column="TRAVE_LOC"/>
			<result property="traveTrans" column="TRAVE_TRANS"/>
			<result property="transTime" column="TRANS_TIME"/>
			<result property="useTime" column="USE_TIME"/>
			<result property="useExpend" column="USE_EXPEND"/>
			<result property="traveDetail" column="TRAVE_DETAIL"/>
			<result property="request" column="REQUEST"/>
	</resultMap>
	
	<select id="chechUser" parameterType="java.util.Map" resultMap="clientInfoVo">
	
		SELECT *
		FROM CLIENT_INFO
		WHERE USER_NAME = #{userName} 
		AND USER_PHONE = #{userPhone}
	
	</select>
	
	<insert id="register">
	
		INSERT INTO CLIENT_INFO(
		
		SEQ
		,USER_NAME
		,USER_PHONE
		,TRAVE_CITY
		,PERIOD
		,EXPEND
		,TRANSPORT
		
		)VALUES(
		CLIENT_SEQ.NEXTVAL
		,#{userName}
		,#{userPhone}
		,#{traveCity}
		,#{period}
		,#{expend}
		,#{transport}
		
		)
	
	</insert>
	
	<select id="registerClient" resultMap="clientInfoVo">
	
		SELECT *
		FROM CLIENT_INFO
	
	</select>
	
	<select id="getName" resultMap="clientInfoVo">
	
		SELECT *
		FROM CLIENT_INFO
		WHERE USER_NAME = #{userName}
	
	</select>
	
<!-- 	<insert id="insertClient">
	</insert> -->
	
	<insert id="insertSchedule">
	
		<foreach collection="traveInfoVo" item="trave" index="index" separator=";" open="DECLARE BEGIN" close="; END;">
	       
	        INSERT INTO TRAVE_INFO 
		        (TRAVE_SEQ
		        , SEQ
		        , TRAVE_DAY
		        , TRAVE_TIME
		        , TRAVE_CITY
		        , TRAVE_COUNTY
		        , TRAVE_LOC
		        , TRAVE_TRANS
		        , TRANS_TIME
		        , USE_TIME
		        , USE_EXPEND
		        , TRAVE_DETAIL
		        , REQUEST)
		        SELECT
		        TRAVE_SEQ.NEXTVAL
		        , #{trave.seq}
		        , #{trave.traveDay}
		        , #{trave.traveTime}
		        , #{trave.traveCity}
		        , #{trave.traveCounty}
		        , #{trave.traveLoc}
		        , #{trave.traveTrans}
		        , #{trave.transTime}
		        <!--usetime 임시  -->
		        , '임시'
		        , #{trave.useExpend}
		        , #{trave.traveDetail}
		        , #{trave.request}
				FROM DUAL
		</foreach>
	
	</insert>
	
	<select id="selectSchedule" resultMap="traveInfoVo">
	
		SELECT * 
		FROM TRAVE_INFO
		WHERE SEQ = #{clientSeq}
	
	</select>
	


</mapper>